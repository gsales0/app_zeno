<section class="componente">
    <span class="componente">
        Cadastro de Produtos
    </span>

    <div class="ferramentas">
        <button
        class="ferramentas"
        (click)="novoRegistro()"
        [disabled]="telaRegistro && !modoConsulta"
        >
            Incluir
        </button>

        <button
        class="ferramentas"
        [disabled]="(telaRegistro && !modoConsulta) || !dataRow.ID_PRODUTO"
        (click)="alterarRegistro()"
        >
            Alterar
        </button>

        <button
        class="ferramentas"
        [disabled]="(telaRegistro && !modoConsulta) || !dataRow.ID_PRODUTO"
        (click)="consultarRegistro()"
        >
            Consultar
        </button>

        <button
        class="ferramentas"
        [disabled]="(telaRegistro && !modoConsulta) || !dataRow.ID_PRODUTO"
        (click)="excluirRegistro()"
        >
            Excluir
        </button>
    </div>

    <div class="container" *ngIf="!telaRegistro">
        <div class="pesquisar">
            <label for="PESQUISAR">
                Pesquisar:
            </label>

            <label for="ID_MES">
                Mês:
            </label>

            <br>

            <select name="ID_MES" id="ID_MES">
                <option value="1">01 - JANEIRO</option>
                <option value="2">02 - FEVEREIRO</option>
                <option value="3">03 - MARÇO</option>
                <option value="4">04 - ABRIL</option>
                <option value="5">05 - MAIO</option>
                <option value="6">06 - JUNHO</option>
                <option value="7">07 - JULHO</option>
                <option value="8">08 - AGOSTO</option>
                <option value="9">09 - SETEMBRO</option>
                <option value="10">10 - OUTUBRO</option>
                <option value="11">11 - NOVEMBRO</option>
                <option value="12">12 - DEZEMBRO</option>
            </select>

            <input
            type="search"
            name="PESQUISAR"
            id="PESQUISAR"
            >

            <button class="pesquisar" (click)="buscarGrid()" >
                Buscar
            </button>

            <button class="pesquisar">
                Filtrar
            </button>
        </div>

        <div class="datagrid">
            <table class="datagrid">
                <thead>
                    <tr>
                        <th style="width: 10%">
                            Código:
                        </th>
                        <th style="width: 35%;">
                            Nome:
                        </th>
                        <th style="width: 35%">
                            Fornecedor:
                        </th>
                        <th style="width: 10%">
                            Ativo:
                        </th>
                    </tr>
                </thead>
                <tbody>
                    <tr
                    *ngFor="let i of dataGrid"
                    (click)="dataRow.ID_PRODUTO = i.ID_PRODUTO"
                    [ngClass]="{ 'selecionada' : dataRow.ID_PRODUTO === i.ID_PRODUTO }"
                    >
                        <td>
                            {{ (i.CD_PRODUTO).toString().padStart(4, '0') }}
                        </td>
                        <td>
                            {{ i.NM_PRODUTO }}
                        </td>
                        <td>
                            {{ i.NM_CREDOR }}
                        </td>
                        <td>
                            {{ i.SN_ATIVO ? "Sim" : "Não" }}
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>
    </div>

    <div class="container" *ngIf="telaRegistro">
        <form
        class="dataform"
        #dataForm="ngForm"
        (ngSubmit)="salvarEditando ? editarRegistro() : salvarRegistro()"
        >

            <!-- LINHA 01 -->
            <label for="CD_PRODUTO" style="width: 10%">
                Código:
            </label>

            <label for="NM_PRODUTO" style="width: 65%">
                Nome:
            </label>

            <label for="TP_PRODUTO" style="width: 12%;">
                Tipo:
            </label>

            <br>

            <input
            type="number"
            name="CD_PRODUTO"
            id="CD_PRODUTO"
            [(ngModel)]="dataRow.CD_PRODUTO"
            [class.invalido]="!dataRow.CD_PRODUTO"
            [disabled]="modoConsulta"

            min="1" max="9999"
            style="width: 10%"
            required
            >

            <input
            type="text"
            name="NM_PRODUTO"
            id="NM_PRODUTO"
            [(ngModel)]="dataRow.NM_PRODUTO"
            [class.invalido]="!dataRow.NM_PRODUTO"
            [disabled]="modoConsulta"

            maxlength="100"
            style="width: 65%"
            required
            >

            <select
            name="TP_PRODUTO"
            id="TP_PRODUTO"
            [(ngModel)]="dataRow.TP_PRODUTO"
            [class.invalido]="!dataRow.TP_PRODUTO"
            [disabled]="modoConsulta"

            style="width: 15%"
            required
            >
                <option hidden></option>
                <option value="P">Produto</option>
                <option value="M">Matéria-Prima</option>
            </select>

            <br>

            <!-- LINHA 02 -->
            <label for="CD_BARRAS" style="width: 20%">
                Código de Barras:
            </label>

            <label for="UN_MEDIDA" style="width: 15%">
                Un. Medida:
            </label>

            <label for="ID_CREDOR" style="width: 52%">
                Fornecedor:
            </label>

            <br>

            <input
            type="number"
            name="CD_BARRAS"
            id="CD_BARRAS"
            [(ngModel)]="dataRow.CD_BARRAS"
            [class.invalido]="!dataRow.CD_BARRAS"
            [disabled]="modoConsulta"

            style="width: 20%"
            required
            >

            <input
            type="text"
            name="UN_MEDIDA"
            id="UN_MEDIDA"
            [(ngModel)]="dataRow.UN_MEDIDA"
            [class.invalido]="!dataRow.UN_MEDIDA"
            [disabled]="modoConsulta"

            maxlength="11"
            style="width: 15%"
            required
            >

            <select
            name="ID_CREDOR"
            id="ID_CREDOR"

            style="width: 54%"
            >
                <option value="" hidden></option>
                <option *ngFor="let i of dataLook" [value]="i.ID_CREDOR">{{i.LK_CREDOR}}</option>
            </select>
            <br>

            <label for="VL_CUSTO" style="width: 4rem">
                Custo:
            </label>

            <label for="VL_DESCONTO" style="width: 10rem">
                Desconto Max.:
            </label>

            <label for="VL_PRECO" style="width: 18rem;">
                Preço:
            </label>

            <select
            name="VL_CUSTO"
            id="VL_CUSTO"
            [(ngModel)]="dataRow.VL_CUSTO"
            [disabled]="modoConsulta"

            style="width: 4.5rem"
            >
            </select>

            <input
            type="text"
            name="VL_DESCONTO"
            id="VL_DESCONTO"
            [(ngModel)]="dataRow.VL_DESCONTO"
            [disabled]="modoConsulta"

            maxlength="100"
            style="width: 10rem"
            >

            <input
            type="text"
            name="VL_PRECO"
            id="VL_PRECO"
            [(ngModel)]="dataRow.VL_PRECO"
            [disabled]="modoConsulta"

            maxlength="100"
            style="width: 18rem"
            >

            <label for="OBSERVACOES" style="width: 85%;">
                Observações:
            </label>

            <label for="SN_ATIVO">
                Ativo:
            </label>

            <input
            type="checkbox"
            name="SN_ATIVO"
            id="SN_ATIVO"
            [(ngModel)]="dataRow.SN_ATIVO"
            [disabled]="modoConsulta"
            >
            
            <br>

            <textarea
            name="OBSERVACOES"
            id="OBSERVACOES"
            [(ngModel)]="dataRow.OBSERVACOES"
            [disabled]="modoConsulta"
            ></textarea>

            <div class="executores">
                <button
                type="button"
                class="executores"
                (click)="cancelarRegistro()"
                >
                    {{ modoConsulta ? "Voltar" : "Cancelar"}}
                </button>

                <button
                type="submit"
                class="executores"
                [disabled]="dataForm.invalid"
                *ngIf="!modoConsulta"
                >
                    {{ salvarEditando ? "Salvar Alteração" : "Salvar Registro" }}
                </button>
            </div>
        </form>
    </div>

</section>


<dialog #modal class="modal">
    <span class="modal">
        {{ mensagem }}
    </span>
    
    <br><br>

    <button
    class="modal"
    (click)="fecharModal()"
    >
        Confirmar!
    </button>
</dialog>